{"version":3,"sources":["pages/home/components/NewList.js"],"names":["page","connect","state","loading","getIn","list","failed","dispatch","handleSendTitle","title","actions","sendTitleAction","handleLoadList","loadListAction","props","useEffect","warn","paragraph","rows","active","map","item","key","id","className","onClick","to","date","tags","join","category","desc","read","info"],"mappings":"kLAkBIA,EAAO,EA+EIC,uBAfS,SAACC,GAAD,MAAY,CACnCC,QAASD,EAAME,MAAM,CAAC,OAAO,YAC7BC,KAAMH,EAAME,MAAM,CAAC,OAAO,SAC1BE,OAAQJ,EAAME,MAAM,CAAC,OAAO,eAGF,SAACG,GAAD,MAAe,CACzCC,gBADyC,SACzBC,GACfF,EAASG,IAAQC,gBAAgBF,KAElCG,eAJyC,SAI1BZ,GACdO,EAASG,IAAQG,eAAeb,QAInBC,EA7EC,SAACa,GAqDhB,OAzCAC,qBAAU,WACTD,EAAMF,eAAe,GACrBZ,MACE,IAEHe,qBAAU,WACND,EAAMR,QACR,IAAQU,KAAK,6FAAmB,KAE/B,CAACF,EAAMR,SAiCT,kBAAC,WAAD,KA7BGQ,EAAMX,QAEP,kBAAC,WAAD,KACC,kBAAC,IAAD,CAAUc,UAAW,CAAEC,KAAM,GAAKf,QAASW,EAAMX,QAASe,MAAI,EAACC,QAAM,IACrE,kBAAC,IAAD,CAAUF,UAAW,CAAEC,KAAM,GAAKf,QAASW,EAAMX,QAASe,MAAI,EAACC,QAAM,IACrE,kBAAC,IAAD,CAAUF,UAAW,CAAEC,KAAM,GAAKf,QAASW,EAAMX,QAASe,MAAI,EAACC,QAAM,KAKtEL,EAAMT,KAAKe,KAAI,SAACC,GACf,OACC,kBAAC,IAAD,CAAUC,IAAKD,EAAKE,IACnB,yBAAKC,UAAU,SAAQ,kBAAC,IAAD,CAAMC,QAAS,WAAKX,EAAMN,gBAAgBa,EAAKZ,QAASiB,GAAE,kBAAaL,EAAKE,KAAOF,EAAKZ,QAC/G,yBAAKe,UAAU,QACd,6BAAMH,EAAKM,MACX,0CAAWN,EAAKO,KAAKC,KAAK,QAC1B,8CAAeR,EAAKS,WAErB,yBAAKN,UAAU,QAAQH,EAAKU,MAC5B,yBAAKP,UAAU,UAAf,qBAA4BH,EAAKW,UAWpClB,EAAMX,QAAU,KAAO,kBAAC,IAAD,CAAUsB,QAtDpC,WACIzB,GAAQ,EACV,IAAQiC,KAAK,wCAAU,IAGxBjC,IACAc,EAAMF,eAAeZ,MAgDI","file":"static/js/13.cef77c3d.chunk.js","sourcesContent":["import React, { useState, useEffect, Fragment } from 'react';\r\nimport { Link } from 'react-router-dom';\r\nimport { message } from 'antd';\r\nimport { connect } from 'react-redux';\r\nimport { actions } from '../store'\r\nimport {\r\n\tListItem,\r\n\tLoadMore,\r\n\tSkeleton\r\n} from '../style';\r\n\r\n/* 重构后的首页文章列表 \r\n\t 日志：\r\n\t 由于该组件获取的title，在Header组件中也需要，\r\n\t 经过思考，这个数据还是应当放入到Redux中管理。\r\n*/\r\n\r\n/* 需要用到的常量要注意在组件外部保存，不然每次渲染都将定义一遍，切记 */\r\nvar page = 1;\r\n\r\nconst NewList = (props) => {\r\n\r\n\tfunction fetchData() {\r\n\t\tif(page >= 2) {\r\n\t\t\tmessage.info(\"就这么多了哦~\",1);\r\n\t\t\treturn;\r\n\t\t}\t\t\r\n\t\tpage++;\r\n\t\tprops.handleLoadList(page);\r\n\t}\r\n\r\n\t//只在挂载完成时渲染一次\r\n\tuseEffect(()=>{\r\n\t\tprops.handleLoadList(1);\r\n\t\tpage++;\r\n\t}, []);\r\n\r\n\tuseEffect(()=>{\r\n\t\tif(props.failed) {\r\n\t\t\tmessage.warn(\"页面数据获取失败，请联系管理员\", 1);\r\n\t\t}\r\n\t}, [props.failed])\r\n\r\n\t//检查加载状态，若数据正在加载，则渲染骨架屏\r\n\tfunction listOrSkele() {\r\n\t\tif(props.loading) {\r\n\t\t\treturn (\r\n\t\t\t\t<Fragment>\r\n\t\t\t\t\t<Skeleton paragraph={{ rows: 5 }} loading={props.loading} rows active></Skeleton>\r\n\t\t\t\t\t<Skeleton paragraph={{ rows: 5 }} loading={props.loading} rows active></Skeleton>\r\n\t\t\t\t\t<Skeleton paragraph={{ rows: 5 }} loading={props.loading} rows active></Skeleton>\r\n\t\t\t\t</Fragment>\r\n\t\t\t)\r\n\t\t} else {\r\n\t\t\treturn (\r\n\t\t\t\tprops.list.map((item)=>{\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t\t<ListItem key={item.id}>\r\n\t\t\t\t\t\t\t<div className=\"title\"><Link onClick={()=>{props.handleSendTitle(item.title)}} to={`/detail/${item.id}`}>{item.title}</Link></div>\r\n\t\t\t\t\t\t\t<div className=\"info\">\r\n\t\t\t\t\t\t\t\t<div>{item.date}</div>\r\n\t\t\t\t\t\t\t\t<div>Tags：{item.tags.join(' | ')}</div>\r\n\t\t\t\t\t\t\t\t<div>Category：{item.category}</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div className=\"desc\">{item.desc}</div>\r\n\t\t\t\t\t\t\t<div className=\"footer\">阅读：{item.read}</div>\r\n\t\t\t\t\t\t</ListItem>\r\n\t\t\t\t\t)\r\n\t\t\t\t})\r\n\t\t\t)\r\n\t\t}\r\n\t}\r\n\t\r\n\treturn (\r\n\t\t<Fragment>\r\n\t\t\t{listOrSkele()}\r\n\t\t\t{props.loading ? null : <LoadMore onClick={fetchData}>查看更多内容</LoadMore>}\r\n\t\t</Fragment>\r\n\t)\r\n\r\n}\r\n\r\nconst mapStateToProps = (state) => ({\r\n\tloading: state.getIn([\"home\",\"loading\"]),\r\n\tlist: state.getIn([\"home\",\"list\"]),\r\n\tfailed: state.getIn([\"home\",\"failed\"])\r\n});\r\n\r\nconst mapDispatchToProps = (dispatch) => ({\r\n\thandleSendTitle(title) {\r\n\t\tdispatch(actions.sendTitleAction(title));\r\n\t},\r\n\thandleLoadList(page) {\r\n\t\tdispatch(actions.loadListAction(page));\r\n\t},\r\n});\r\n\r\nexport default connect( mapStateToProps, mapDispatchToProps )( NewList );"],"sourceRoot":""}